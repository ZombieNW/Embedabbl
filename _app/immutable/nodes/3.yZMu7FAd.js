import"../chunks/DsnmJJEf.js";import{i as J}from"../chunks/CrmY_bIH.js";import{o as K,a as W,s as P,e as X}from"../chunks/CmZL5jg2.js";import{v as O,o as h,y as a,g as e,B as f,A as g,C as d,z as s,n as m,x as Q,w as E,u as A,h as Y,D as L,E as Z,l as ee,$ as te,k as T,m as G,p as re}from"../chunks/ChX04ls-.js";import{p as H,i as z,s as ae,a as se}from"../chunks/C32WqPaa.js";import{s as oe}from"../chunks/lNiEpzRQ.js";import{c as ie}from"../chunks/C40SgIQj.js";import{b as ne}from"../chunks/BRNV2zGv.js";const le=()=>{const u=oe;return{page:{subscribe:u.page.subscribe},navigating:{subscribe:u.navigating.subscribe},updated:u.updated}},ce={subscribe(u){return le().page.subscribe(u)}};var de=h('<div class="absolute inset-0 flex items-center justify-center bg-gray-900"><div class="text-center"><div class="mb-4 inline-block h-12 w-12 animate-spin rounded-full border-b-2 border-blue-500"></div> <p class="text-gray-300"> </p></div></div>'),ve=h('<div class="absolute inset-0 flex items-center justify-center bg-slate-900"><div class="max-w-lg rounded-lg border border-violet-900 bg-violet-900/10 p-6"><h3 class="mb-2 text-lg font-bold text-red-500">Error Loading Content</h3> <p class="text-slate-300"> </p> <button class="mt-4 rounded bg-red-500 px-4 py-2 text-white transition hover:bg-red-600">Retry</button></div></div>'),ue=h('<div class="relative h-screen w-full"><!> <!> <div class="h-full w-full" id="container"></div></div>');function pe(u,y){O(y,!1);let o=H(y,"core",8),F=H(y,"contentUrl",8),w=f(),p=f(!0),r=f("");async function C(t,n){for(const l of t)await new Promise((v,_)=>{if(document.querySelector(`script[src="${l}"]`)){v(null);return}const c=document.createElement("script");c.src=l,c.type=n?"module":"text/javascript",c.onload=()=>v(null),c.onerror=()=>_(new Error(`Failed to load ${l}`)),document.head.appendChild(c),console.log("Script loaded:",l)})}async function j(){try{if(d(p,!0),d(r,""),o().prescript&&(console.log("Running Pre-Script"),await o().prescript(e(w),F())),o().scripts&&o().scripts.length>0){const t=typeof o().module=="boolean"?o().module:!1;await C(o().scripts,t)}await o().initialize(e(w),F()),d(p,!1)}catch(t){console.error("Failed to initialize core:",t),d(r,t instanceof Error?t.message:"Failed to load content"),d(p,!1)}}K(()=>{j()}),W(()=>{o().cleanup&&o().cleanup()}),J();var U=ue(),i=a(U);{var k=t=>{var n=de(),l=a(n),v=g(a(l),2),_=a(v);s(v),s(l),s(n),E(()=>P(_,`Loading ${Y(o()),A(()=>o().name)??""}...`)),m(t,n)};z(i,t=>{e(p)&&t(k)})}var M=g(i,2);{var D=t=>{var n=ve(),l=a(n),v=g(a(l),2),_=a(v,!0);s(v);var b=g(v,2);s(l),s(n),E(()=>P(_,e(r))),X("click",b,j),m(t,n)};z(M,t=>{e(r)&&t(D)})}var V=g(M,2);ne(V,t=>d(w,t),()=>e(w)),s(U),m(u,U),Q()}var be=h('<div class="absolute inset-0 flex items-center justify-center bg-gray-900"><div class="text-center"><div class="mb-4 inline-block h-12 w-12 animate-spin rounded-full border-b-2 border-blue-500"></div> <p class="text-gray-300"> </p></div></div>'),fe=h('<div class="absolute inset-0 flex items-center justify-center bg-slate-900"><div class="max-w-lg rounded-lg border border-violet-900 bg-violet-900/10 p-6"><h3 class="mb-2 text-lg font-bold text-red-500">Missing Content URL</h3> <p class="text-slate-300"> </p></div></div>'),me=h('<div class="absolute inset-0 flex items-center justify-center bg-slate-900"><div class="max-w-lg rounded-lg border border-violet-900 bg-violet-900/10 p-6"><h3 class="mb-2 text-lg font-bold text-red-500">Core Not Found</h3> <p class="text-slate-300"> </p> <a href="/" class="mt-4 rounded bg-red-500 px-4 py-2 text-white transition hover:bg-red-600">View Available Cores</a></div></div>'),ge=h('<div class="overflow-hidden"><!></div>');function Le(u,y){O(y,!1);const o=()=>se(ce,"$page",F),[F,w]=ae(),p=f(),r=f(),C=f(),j=f(),U=f();let i=f(null);K(()=>{const t=new URLSearchParams(window.location.search);d(i,t.get(e(r).paramName)||"not-found"),console.log("Content URL:",e(i))}),L(()=>o(),()=>{d(p,o().params.core)}),L(()=>e(p),()=>{d(r,ie[e(p)])}),L(()=>e(i),()=>{e(i)}),L(()=>(e(r),e(i)),()=>{d(C,e(r)&&e(i)&&e(i)!="not-found")}),L(()=>(e(r),e(i)),()=>{d(j,e(r)&&!e(i))}),L(()=>(e(r),e(i)),()=>{d(U,e(r)&&e(i)=="not-found")}),Z(),J();var k=ge();ee(t=>{E(()=>te.title=(e(C),e(r),A(()=>e(C)?`${e(r).name} - Embedabbl`:"Embedabbl")??""))});var M=a(k);{var D=t=>{pe(t,{get core(){return e(r)},get contentUrl(){return e(i)}})},V=t=>{var n=T(),l=G(n);{var v=b=>{var c=be(),N=a(c),q=g(a(N),2),B=a(q);s(q),s(N),s(c),E(()=>P(B,`Loading ${e(r),A(()=>e(r).name)??""}...`)),m(b,c)},_=b=>{var c=T(),N=G(c);{var q=$=>{var x=fe(),R=a(x),S=g(a(R),2),I=a(S);s(S),s(R),s(x),E(()=>P(I,`Please provide a content URL using the ${e(r),A(()=>e(r).paramName)??""} query parameter.`)),m($,x)},B=$=>{var x=me(),R=a(x),S=g(a(R),2),I=a(S);s(S),re(2),s(R),s(x),E(()=>P(I,`The core ${e(p)??""} could not be found or no longer exists.`)),m($,x)};z(N,$=>{e(U)?$(q):$(B,!1)},!0)}m(b,c)};z(l,b=>{e(j)?b(v):b(_,!1)},!0)}m(t,n)};z(M,t=>{e(C)?t(D):t(V,!1)})}s(k),m(u,k),Q(),w()}export{Le as component};
